import csv
import serial

s = ("OAD ready. \nSDC Voltage Good: 1882 mV"
"       \n SW Version: \"v0.4.0\", Hash: 0e9a71c58f694b4edde8c6add7092b2bcb3eb7c9"
"       \n Mounting FS."
"       \n Sensors initialized."
"       \n OAD ready."
"       \n SDC Voltage Good: 1882 mV"
"       \n SW Version: \"v0.4.0\", Hash: 0e9a71c58f694b4edde8c6add7092b2bcb3eb7c9"
"       \n Mounting FS."
"       \n Sensors initialized."
"       \n OAD ready."
"       \n SDC Voltage Good: 1882 mV"
"       \n SW Version: \"v0.4.0\", Hash: 0e9a71c58f694b4edde8c6add7092b2bcb3eb7c9"
"       \n Mounting FS."
"       \n File timeFile is 10 bytes"
"       \n Read 10 bytes from timeFile"
"       \n RTC time loaded."
"       \n Valid UTC date/time restored from time file:"
"              \n  Mon Aug  2 20:56:04 2021"
"       \n "
"       \n Removed file: timeFile"
"       \n Wrote 10 bytes to file: timeFile"
"       \n RTC time saved."
"       \n Current system time: 1627937766"
"       \n System Reset Value: 0"
"       \n System reset reason: RSTSRC_PWR_ON"
"       \n JTAG power domain is OFF. Disabling TCK to prevent erroneous HIB."
"       \n scCtrlReadyCallback"
"       \n scCtrlReadyCallback"
"       \n scCtrlReadyCallback"
"       \n Waiting for SC to be ready..."
"       \n SC_start success"
"      \n File deviceinfo is 102 bytes"
"      \n Read 102 bytes from deviceinfo"
"      \n Device info loaded."
"      \n Device Info:"
"          \n   HW Ver: 0.4.X"
"             \n  Tag GUID: 89148000-0070-2584-6599-5893d8179ad1"
# "              \n Animal GUID: 078a85de-bfd5-478e-9c03-68d641953098"
"              \n SN: 00000000"
"              \n BT MAC: 5893d8179ad1"
"      \n File ID    Size    Name"
"      \n 0035    1087    428f92ef-5a98-48eb-9dc4-60fba976b492_1626461293.csv"
"      \n 0069     102    deviceinfo"
"      \n 009d     741    89148000-0070-2584-6599-5893d8179ad1_1627937587.csv"
"      \n 0001      10    timeFile"
"      \n Filesystem             Size      Used       Avail   Use%    Mounted on"
"      \n NVSEXTERNAL_FS      6739601      3514     6736087     0%    /"
"      \n Wrote 463 bytes to file: 89148000-0070-2584-6599-5893d8179ad1_1627937770.csv"
"      \n Created new log file."
"     \n  Accelerometer initialization complete"
"     \n  Accel/gyro self test passed"
"     \n  Compass initialization complete"
"     \n  Compass measurement timed out!"
"     \n  Failed to read normal data for compass self test"
"    \n   Compass self test failed"
"     \n  Barometer initialization complete"
"    \n   Barometer self test passed"
"    \n   VBAT=4.098384 VSOLAR=0.000000"
"     \n  Compass measurement timed out!"
"      \n "
"    \n   Updating BLE Advertisement Array."
"    \n   Wrote 86 bytes to file: 89148000-0070-2584-6599-5893d8179ad1_1627937770.csv"
"    \n   File 89148000-0070-2584-6599-5893d8179ad1_1627937770.csv is 549 bytes"
"     \n  [CELL UART ON]"
"     \n  Waiting for cell APP RDY"
"    \n   Cell FW Version: BG77LAR02A04_01.003.01.003"
"     \n  IMEI: 866349042518708"
"    \n   ICCID: 89148000007025846599"
"    \n   Device info generated."
"    \n   Device Info:"
"     \n          HW Ver: 0.4.X"
"     \n          Tag GUID: 89148000-0070-2584-6599-5893d8179ad1"
# "     \n          Animal GUID: 078a85de-bfd5-478e-9c03-68d641953098"
"    \n           SN: 00000000"
"    \n           BT MAC: 5893d8179ad1"
"    \n   Removed file: deviceinfo"
"    \n   Wrote 102 bytes to file: deviceinfo"
"    \n   Device info saved."
"    \n   Attempting to get Cell Network time."
"   \n    Removed file: timeFile"
"    \n   Wrote 10 bytes to file: timeFile"
"    \n   RTC time saved."
"    \n   Current cell time: 1628005135"
"   \n    Cell time acquired."
"    \n   Attempting FTP Upload."
"      \n   Transferring log to UFS."
"      \n   Newest log to upload: 89148000-0070-2584-6599-5893d8179ad1_1627937587.csv"
"      \n   [HANDLE] 1 -> 89148000-0070-2584-6599-5893d8179ad1_1627937587.csv"
"      \n   Read 741 bytes from 89148000-0070-2584-6599-5893d8179ad1_1627937587.csv"
"      \n   Read 0 bytes from 89148000-0070-2584-6599-5893d8179ad1_1627937587.csv"
"      \n   FTP open"
"     \n    Downloading xtag.bin to xtag.bin"
"      \n   Failed to download xtag.bin."
"      \n   oad no update found"
"      \n   Uploading 89148000-0070-2584-6599-5893d8179ad1_1627937587.csv to 89148000-0070-2584-6599-5893d8179ad1_1627937587.csv"
"      \n   FTP upload completed successfully."
"      \n   Removing log file."
"      \n   Removed file: 89148000-0070-2584-6599-5893d8179ad1_1627937587.csv"
"      \n   No log file to upload found."
"      \n   No log file to upload found."
"      \n   All logs uploaded successfully."
"      \n   FTP upload complete."
"      \n   [Attempting GPS Lock]"
"      \n   Cell/GPS startup run complete."
"       \n "
"     \n    Updating BLE Advertisement Array."
"      \n   Wrote 97 bytes to file: 89148000-0070-2584-6599-5893d8179ad1_1627937770.csv"
"      \n   File 89148000-0070-2584-6599-5893d8179ad1_1627937770.csv is 646 bytes"
"\n   [Attempting GPS Lock]"
"      \n   [Attempting GPS Lock]"
"      \n   [Attempting GPS Lock]"
"       \n  [Attempting GPS Lock]"
"       \n  [Attempting GPS Lock]")

port = "COM9"
ser = serial.Serial(port, 115200, timeout=10)

bstring = bytes(s, "utf=8")

def main():
    ser.write(bstring)

if __name__ == "__main__":
        if ser.isOpen():
                main()
        else:
                print("ERROR: CAN't OPEN CONNECTION")
        ser.close()
